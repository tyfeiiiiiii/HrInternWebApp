@model HrInternWebApp.Models.Identity.EditEmp
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Edit Employee";
    var isAdmin = HttpContextAccessor.HttpContext.Session.GetString("Role") == "Admin";
}

<div class="container" style="margin-top: 20px;">
    <h2>Edit Employee - ID: @Model.empId</h2>
    <form asp-action="EditEmp" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="empId" />

        <div class="form-group">
            <label asp-for="username" class="control-label"></label>
            <input asp-for="username" class="form-control" readonly="true" /> @* Make username readonly for all *@ 
        </div>

        <div class="form-group">
            <label asp-for="email" class="control-label"></label>
            <input asp-for="email" type="email" class="form-control" readonly="@(!isAdmin)" /> @* only for admins  *@
        </div>

        @if (isAdmin)
        {
            <div class="form-group">
                <label asp-for="Role" class="control-label"></label>
                <select asp-for="Role" class="form-control">
                    <option value="Admin">Admin</option>
                    <option value="Manager">Manager</option>
                    <option value="Senior">Senior</option>
                    <option value="Junior">Junior</option>
                </select>
            </div>

            <div class="form-group">
                <label asp-for="Department" class="control-label"></label>
                <select asp-for="Department" class="form-control">
                    <option value="Finance">Finance</option>
                    <option value="IT">IT</option>
                    <option value="Human Resource">Human Resource</option>
                    <option value="Logistic">Logistic</option>
                    <option value="Consultant">Consultant</option>
                    <option value="Operation">Operation</option>
                </select>
            </div>
        }

        <div class="form-group">
            <label asp-for="profilePic" class="control-label">Upload Profile Picture</label>
            <input type="file" name="ProfilePic" class="form-control-file" accept="image/*" @(!isAdmin ? "disabled" : "") /> <!-- Disable upload if not admin -->
        </div>

        @if (isAdmin)
        {
            <button type="submit" class="btn btn-primary">Save changes</button>
        }
        <a asp-action="ViewEmp" class="btn btn-secondary">Cancel</a>
    </form>
</div>
